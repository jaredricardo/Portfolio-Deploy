{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _func = require('./utils/func');\n\nvar _scroll = require('./utils/scroll');\n\nvar _hash = require('./utils/hash');\n\nvar _meta = require('./utils/meta');\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar defaultConfig = {\n  affectHistory: false,\n  debounce: 100,\n  keepLastAnchorHash: false,\n  offset: 0,\n  scrollBehaviour: 'smooth',\n  scrollDelay: 0,\n  scrollOnImagesLoad: false,\n  onSectionEnter: null,\n  meta: null,\n  reloadOnGoingBack: false\n};\nvar EVENT_IMAGES_LOADED = 'images:loaded';\n\nvar Manager = function Manager() {\n  var _this = this;\n\n  _classCallCheck(this, Manager);\n\n  this.getBasePath = function (anchors) {\n    var newBasePath = ('' + window.location.origin + window.location.pathname).replace(/\\/$/, '');\n\n    if (anchors) {\n      Object.keys(anchors).forEach(function (id) {\n        if (!anchors[id].exact && newBasePath.endsWith(anchors[id].name)) {\n          newBasePath = newBasePath.replace('/' + anchors[id].name, '');\n        }\n      });\n    }\n\n    return newBasePath;\n  };\n\n  this.addListeners = function () {\n    window.addEventListener('scroll', _this.scrollHandler, true);\n    window.addEventListener('hashchange', _this.handleHashChange);\n    /* window.addEventListener('onpopstate', this.getBasePath); */\n  };\n\n  this.removeListeners = function () {\n    window.removeEventListener('scroll', _this.scrollHandler, true);\n    window.removeEventListener('hashchange', _this.handleHashChange);\n    /* window.addEventListener('onpopstate', this.getBasePath); */\n  };\n\n  this.configure = function (config) {\n    _this.config = _extends({}, defaultConfig, config);\n\n    _this.resetDefaultMetaTags();\n  };\n\n  this.resetDefaultMetaTags = function () {\n    if (_this.config.meta) {\n      _this.defaultMetaTags = (0, _meta.getDefaultMetaTags)(_this.config.meta);\n      (0, _meta.setMetaTags)(_this.defaultMetaTags);\n    } else {\n      _this.defaultMetaTags = (0, _meta.getDefaultMetaTags)();\n    }\n  };\n\n  this.setDefaultMetaTags = function () {\n    (0, _meta.setMetaTags)(_this.defaultMetaTags);\n  };\n\n  this.goToTop = function () {\n    if ((0, _scroll.getScrollTop)() === 0) return;\n    _this.forcedHash = true;\n    (0, _scroll.scrollTo)({\n      top: 0,\n      behavior: _this.config.scrollBehaviour\n    });\n  };\n\n  this.addAnchor = function (_ref) {\n    var element = _ref.element,\n        name = _ref.name,\n        hash = _ref.hash,\n        id = _ref.id,\n        meta = _ref.meta,\n        exact = _ref.exact; // if this is the first anchor, set up listeners\n\n    if (Object.keys(_this.anchors).length === 0) {\n      _this.addListeners();\n    }\n\n    var urlName = name || '';\n    var urlHash = hash ? '#' + hash : ''; // check if this anchor is the current one\n\n    if (window.location.href.endsWith('' + urlName + urlHash)) {\n      _this.forceHashUpdate();\n    }\n\n    if (window.location.pathname.endsWith('/' + urlName)) {\n      _this.basePathName = _this.basePathName.replace('/' + urlName, '');\n      if (_this.basePathName === '') _this.basePathName = '/';\n    }\n\n    _this.anchors[id] = {\n      id: id,\n      component: element,\n      name: name,\n      hash: hash,\n      meta: meta,\n      exact: exact\n    };\n    _this.basePath = _this.getBasePath(_this.anchors);\n\n    _this.normalizeMetaTags();\n  };\n\n  this.normalizeMetaTags = function () {\n    Object.keys(_this.anchors).forEach(function (anchorId) {\n      var anchor = _this.anchors[anchorId];\n\n      if (anchor.hash && !anchor.meta) {\n        if (anchor.exact || !anchor.name) {\n          anchor.meta = _this.defaultMetaTags;\n        } else if (anchor.name) {\n          var parentAnchor = (0, _func.getAnchoreByName)(_this.anchors, anchor.name);\n\n          if (parentAnchor) {\n            anchor.meta = parentAnchor.meta;\n          }\n        }\n      }\n    });\n  };\n\n  this.removeAnchor = function (id) {\n    delete _this.anchors[id]; // if this is the last anchor, remove listeners\n\n    if (Object.keys(_this.anchors).length === 0) {\n      _this.removeListeners();\n    }\n  };\n\n  this.onSectionChange = function (newAnchor, oldAnchor) {\n    var onSectionEnter = _this.config.onSectionEnter;\n\n    var getPath = function getPath(anchor) {\n      return anchor.name ? anchor.exact ? '/' + anchor.name : (_this.basePathName !== '/' ? _this.basePathName : '') + '/' + anchor.name : _this.basePathName;\n    };\n\n    if (typeof onSectionEnter === 'function') {\n      var nextState = newAnchor ? _extends({}, _this.anchors[newAnchor], {\n        id: newAnchor\n      }) : {};\n      nextState.path = getPath(nextState);\n      var prevState = oldAnchor ? _extends({}, _this.anchors[oldAnchor], {\n        id: oldAnchor\n      }) : {};\n      prevState.path = getPath(prevState);\n      onSectionEnter(nextState, prevState);\n    }\n  };\n\n  this.handleScroll = function () {\n    var _config = _this.config,\n        offset = _config.offset,\n        keepLastAnchorHash = _config.keepLastAnchorHash,\n        affectHistory = _config.affectHistory;\n    var nextAnchor = (0, _scroll.getBestAnchorGivenScrollLocation)(_this.anchors, -offset);\n    var prevAnchor = (0, _hash.getHash)({\n      manager: _this\n    });\n\n    if (nextAnchor && prevAnchor !== nextAnchor) {\n      _this.forcedHash = true;\n      (0, _hash.updateHash)({\n        anchor: _this.anchors[nextAnchor],\n        affectHistory: affectHistory,\n        manager: _this\n      });\n\n      _this.onSectionChange(nextAnchor, prevAnchor);\n    } else if (!nextAnchor && !keepLastAnchorHash) {\n      (0, _hash.removeHash)({\n        manager: _this\n      });\n\n      if (_this.anchors[prevAnchor]) {\n        _this.onSectionChange(null, prevAnchor);\n      }\n    }\n  };\n\n  this.handleHashChange = function (e) {\n    _this.basePath = _this.getBasePath(_this.anchors);\n\n    if (_this.forcedHash) {\n      _this.forcedHash = false;\n    } else {\n      var hash = (0, _hash.getHash)({\n        manager: _this\n      });\n\n      var runScrollingToSection = function runScrollingToSection() {\n        var delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        return _this.goToSection(hash, delay);\n      };\n\n      if (_this.config.scrollOnImagesLoad && !_this.imagesAreLoaded) {\n        window.addEventListener(EVENT_IMAGES_LOADED, runScrollingToSection, false);\n      } else {\n        runScrollingToSection(_this.config.scrollDelay);\n      }\n    }\n  };\n\n  this.goToSection = function (id) {\n    var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var element = (_this.anchors[id] ? _this.anchors[id].component : null) || document.getElementById(id);\n    var offset = _this.config.offset;\n\n    if (element) {\n      setTimeout(function () {\n        var marginTop = ~~(element.currentStyle || window.getComputedStyle(element).marginTop.replace(/\\D+/g, ''));\n        var elementPosition = element.getBoundingClientRect().top;\n        var offsetPosition = elementPosition - offset;\n        (0, _scroll.scrollTo)({\n          top: offsetPosition,\n          behavior: _this.config.scrollBehaviour\n        });\n      }, delay);\n    }\n  };\n\n  this.anchors = {};\n  this.forcedHash = false;\n  this.config = defaultConfig;\n  this.scrollHandler = (0, _func.debounce)(this.handleScroll, ~~this.config.debounce);\n  this.forceHashUpdate = (0, _func.debounce)(this.handleHashChange, 1);\n  this.basePath = this.getBasePath();\n  this.basePathName = window.location.pathname;\n  this.imagesAreLoaded = false;\n  this.resetDefaultMetaTags();\n  setTimeout(function () {\n    var eventDispatched = false;\n\n    var fireEvent = function fireEvent() {\n      if (!eventDispatched) {\n        var event = new Event(EVENT_IMAGES_LOADED);\n        window.dispatchEvent(event);\n      }\n\n      eventDispatched = true;\n    };\n\n    if (_this.config.scrollOnImagesLoad) {\n      if (_this.config.scrollOnImagesLoad > 1) {\n        setTimeout(fireEvent, parseInt(_this.config.scrollOnImagesLoad, 10));\n      }\n\n      var imgs = document.images;\n      var len = imgs.length;\n      var counter = 0;\n\n      var incrementCounter = function incrementCounter() {\n        counter++;\n\n        if (counter === len) {\n          _this.imagesAreLoaded = true;\n          fireEvent();\n        }\n      };\n\n      [].forEach.call(imgs, function (img) {\n        if (img.complete) {\n          incrementCounter();\n        } else {\n          img.addEventListener('load', incrementCounter, false);\n        }\n      });\n    }\n  });\n\n  if (window.history && window.history.pushState) {\n    window.addEventListener('popstate', function () {\n      if (_this.config.reloadOnGoingBack) {\n        window.location.reload();\n      }\n    });\n  }\n};\n\nexports.default = new Manager();","map":{"version":3,"sources":["/Users/jaredricardo/Desktop/apps/portfolio/node_modules/react-update-url-on-scroll/lib/Manager.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_func","require","_scroll","_hash","_meta","_classCallCheck","instance","Constructor","TypeError","defaultConfig","affectHistory","debounce","keepLastAnchorHash","offset","scrollBehaviour","scrollDelay","scrollOnImagesLoad","onSectionEnter","meta","reloadOnGoingBack","EVENT_IMAGES_LOADED","Manager","_this","getBasePath","anchors","newBasePath","window","location","origin","pathname","replace","keys","forEach","id","exact","endsWith","name","addListeners","addEventListener","scrollHandler","handleHashChange","removeListeners","removeEventListener","configure","config","resetDefaultMetaTags","defaultMetaTags","getDefaultMetaTags","setMetaTags","setDefaultMetaTags","goToTop","getScrollTop","forcedHash","scrollTo","top","behavior","addAnchor","_ref","element","hash","urlName","urlHash","href","forceHashUpdate","basePathName","component","basePath","normalizeMetaTags","anchorId","anchor","parentAnchor","getAnchoreByName","removeAnchor","onSectionChange","newAnchor","oldAnchor","getPath","nextState","path","prevState","handleScroll","_config","nextAnchor","getBestAnchorGivenScrollLocation","prevAnchor","getHash","manager","updateHash","removeHash","e","runScrollingToSection","delay","undefined","goToSection","imagesAreLoaded","document","getElementById","setTimeout","marginTop","currentStyle","getComputedStyle","elementPosition","getBoundingClientRect","offsetPosition","eventDispatched","fireEvent","event","Event","dispatchEvent","parseInt","imgs","images","len","counter","incrementCounter","img","complete","history","pushState","reload","default"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _func = require('./utils/func');\n\nvar _scroll = require('./utils/scroll');\n\nvar _hash = require('./utils/hash');\n\nvar _meta = require('./utils/meta');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar defaultConfig = {\n  affectHistory: false,\n  debounce: 100,\n  keepLastAnchorHash: false,\n  offset: 0,\n  scrollBehaviour: 'smooth',\n  scrollDelay: 0,\n  scrollOnImagesLoad: false,\n  onSectionEnter: null,\n  meta: null,\n  reloadOnGoingBack: false\n};\n\nvar EVENT_IMAGES_LOADED = 'images:loaded';\n\nvar Manager = function Manager() {\n  var _this = this;\n\n  _classCallCheck(this, Manager);\n\n  this.getBasePath = function (anchors) {\n    var newBasePath = ('' + window.location.origin + window.location.pathname).replace(/\\/$/, '');\n\n    if (anchors) {\n      Object.keys(anchors).forEach(function (id) {\n        if (!anchors[id].exact && newBasePath.endsWith(anchors[id].name)) {\n          newBasePath = newBasePath.replace('/' + anchors[id].name, '');\n        }\n      });\n    }\n\n    return newBasePath;\n  };\n\n  this.addListeners = function () {\n    window.addEventListener('scroll', _this.scrollHandler, true);\n    window.addEventListener('hashchange', _this.handleHashChange);\n    /* window.addEventListener('onpopstate', this.getBasePath); */\n  };\n\n  this.removeListeners = function () {\n    window.removeEventListener('scroll', _this.scrollHandler, true);\n    window.removeEventListener('hashchange', _this.handleHashChange);\n    /* window.addEventListener('onpopstate', this.getBasePath); */\n  };\n\n  this.configure = function (config) {\n    _this.config = _extends({}, defaultConfig, config);\n    _this.resetDefaultMetaTags();\n  };\n\n  this.resetDefaultMetaTags = function () {\n    if (_this.config.meta) {\n      _this.defaultMetaTags = (0, _meta.getDefaultMetaTags)(_this.config.meta);\n      (0, _meta.setMetaTags)(_this.defaultMetaTags);\n    } else {\n      _this.defaultMetaTags = (0, _meta.getDefaultMetaTags)();\n    }\n  };\n\n  this.setDefaultMetaTags = function () {\n    (0, _meta.setMetaTags)(_this.defaultMetaTags);\n  };\n\n  this.goToTop = function () {\n    if ((0, _scroll.getScrollTop)() === 0) return;\n    _this.forcedHash = true;\n\n    (0, _scroll.scrollTo)({\n      top: 0,\n      behavior: _this.config.scrollBehaviour\n    });\n  };\n\n  this.addAnchor = function (_ref) {\n    var element = _ref.element,\n        name = _ref.name,\n        hash = _ref.hash,\n        id = _ref.id,\n        meta = _ref.meta,\n        exact = _ref.exact;\n\n    // if this is the first anchor, set up listeners\n    if (Object.keys(_this.anchors).length === 0) {\n      _this.addListeners();\n    }\n\n    var urlName = name || '';\n    var urlHash = hash ? '#' + hash : '';\n\n    // check if this anchor is the current one\n    if (window.location.href.endsWith('' + urlName + urlHash)) {\n      _this.forceHashUpdate();\n    }\n    if (window.location.pathname.endsWith('/' + urlName)) {\n      _this.basePathName = _this.basePathName.replace('/' + urlName, '');\n      if (_this.basePathName === '') _this.basePathName = '/';\n    }\n\n    _this.anchors[id] = {\n      id: id,\n      component: element,\n      name: name,\n      hash: hash,\n      meta: meta,\n      exact: exact\n    };\n\n    _this.basePath = _this.getBasePath(_this.anchors);\n\n    _this.normalizeMetaTags();\n  };\n\n  this.normalizeMetaTags = function () {\n    Object.keys(_this.anchors).forEach(function (anchorId) {\n      var anchor = _this.anchors[anchorId];\n      if (anchor.hash && !anchor.meta) {\n\n        if (anchor.exact || !anchor.name) {\n          anchor.meta = _this.defaultMetaTags;\n        } else if (anchor.name) {\n          var parentAnchor = (0, _func.getAnchoreByName)(_this.anchors, anchor.name);\n\n          if (parentAnchor) {\n            anchor.meta = parentAnchor.meta;\n          }\n        }\n      }\n    });\n  };\n\n  this.removeAnchor = function (id) {\n    delete _this.anchors[id];\n    // if this is the last anchor, remove listeners\n    if (Object.keys(_this.anchors).length === 0) {\n      _this.removeListeners();\n    }\n  };\n\n  this.onSectionChange = function (newAnchor, oldAnchor) {\n    var onSectionEnter = _this.config.onSectionEnter;\n\n    var getPath = function getPath(anchor) {\n      return anchor.name ? anchor.exact ? '/' + anchor.name : (_this.basePathName !== '/' ? _this.basePathName : '') + '/' + anchor.name : _this.basePathName;\n    };\n\n    if (typeof onSectionEnter === 'function') {\n      var nextState = newAnchor ? _extends({}, _this.anchors[newAnchor], { id: newAnchor }) : {};\n      nextState.path = getPath(nextState);\n\n      var prevState = oldAnchor ? _extends({}, _this.anchors[oldAnchor], { id: oldAnchor }) : {};\n      prevState.path = getPath(prevState);\n\n      onSectionEnter(nextState, prevState);\n    }\n  };\n\n  this.handleScroll = function () {\n    var _config = _this.config,\n        offset = _config.offset,\n        keepLastAnchorHash = _config.keepLastAnchorHash,\n        affectHistory = _config.affectHistory;\n\n    var nextAnchor = (0, _scroll.getBestAnchorGivenScrollLocation)(_this.anchors, -offset);\n    var prevAnchor = (0, _hash.getHash)({ manager: _this });\n\n    if (nextAnchor && prevAnchor !== nextAnchor) {\n      _this.forcedHash = true;\n\n      (0, _hash.updateHash)({\n        anchor: _this.anchors[nextAnchor],\n        affectHistory: affectHistory,\n        manager: _this\n      });\n\n      _this.onSectionChange(nextAnchor, prevAnchor);\n    } else if (!nextAnchor && !keepLastAnchorHash) {\n      (0, _hash.removeHash)({ manager: _this });\n      if (_this.anchors[prevAnchor]) {\n        _this.onSectionChange(null, prevAnchor);\n      }\n    }\n  };\n\n  this.handleHashChange = function (e) {\n    _this.basePath = _this.getBasePath(_this.anchors);\n\n    if (_this.forcedHash) {\n      _this.forcedHash = false;\n    } else {\n      var hash = (0, _hash.getHash)({ manager: _this });\n      var runScrollingToSection = function runScrollingToSection() {\n        var delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        return _this.goToSection(hash, delay);\n      };\n\n      if (_this.config.scrollOnImagesLoad && !_this.imagesAreLoaded) {\n        window.addEventListener(EVENT_IMAGES_LOADED, runScrollingToSection, false);\n      } else {\n        runScrollingToSection(_this.config.scrollDelay);\n      }\n    }\n  };\n\n  this.goToSection = function (id) {\n    var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n    var element = (_this.anchors[id] ? _this.anchors[id].component : null) || document.getElementById(id);\n    var offset = _this.config.offset;\n\n\n    if (element) {\n      setTimeout(function () {\n        var marginTop = ~~(element.currentStyle || window.getComputedStyle(element).marginTop.replace(/\\D+/g, ''));\n        var elementPosition = element.getBoundingClientRect().top;\n        var offsetPosition = elementPosition - offset;\n\n        (0, _scroll.scrollTo)({\n          top: offsetPosition,\n          behavior: _this.config.scrollBehaviour\n        });\n      }, delay);\n    }\n  };\n\n  this.anchors = {};\n  this.forcedHash = false;\n  this.config = defaultConfig;\n\n  this.scrollHandler = (0, _func.debounce)(this.handleScroll, ~~this.config.debounce);\n  this.forceHashUpdate = (0, _func.debounce)(this.handleHashChange, 1);\n\n  this.basePath = this.getBasePath();\n  this.basePathName = window.location.pathname;\n  this.imagesAreLoaded = false;\n\n  this.resetDefaultMetaTags();\n\n  setTimeout(function () {\n    var eventDispatched = false;\n    var fireEvent = function fireEvent() {\n      if (!eventDispatched) {\n        var event = new Event(EVENT_IMAGES_LOADED);\n        window.dispatchEvent(event);\n      }\n      eventDispatched = true;\n    };\n\n    if (_this.config.scrollOnImagesLoad) {\n\n      if (_this.config.scrollOnImagesLoad > 1) {\n        setTimeout(fireEvent, parseInt(_this.config.scrollOnImagesLoad, 10));\n      }\n\n      var imgs = document.images;\n      var len = imgs.length;\n      var counter = 0;\n\n      var incrementCounter = function incrementCounter() {\n        counter++;\n\n        if (counter === len) {\n          _this.imagesAreLoaded = true;\n          fireEvent();\n        }\n      };\n\n      [].forEach.call(imgs, function (img) {\n        if (img.complete) {\n          incrementCounter();\n        } else {\n          img.addEventListener('load', incrementCounter, false);\n        }\n      });\n    }\n  });\n\n  if (window.history && window.history.pushState) {\n    window.addEventListener('popstate', function () {\n      if (_this.config.reloadOnGoingBack) {\n        window.location.reload();\n      }\n    });\n  }\n};\n\nexports.default = new Manager();"]},"metadata":{},"sourceType":"script"}